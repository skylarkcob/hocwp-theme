window.wp=window.wp||{};jQuery(document).ready(function(a){a.fn.hocwpCodeEditor=function(b){if(wp.codeEditor){var c=a.extend(wp.codeEditor.defaultSettings,a.fn.hocwpCodeEditor.defaults,b);return this.each(function(){var k=c,f=a(this),h=f.next(),g=f.closest("div.widget"),i=f.attr("data-mode");if(!a.trim(i)){i="htmlmixed"}k.codemirror.mode=i;var l=null;if(!f.hasClass("initialized")||null===l){l=wp.codeEditor.initialize(f,k);f.addClass("initialized")}l.codemirror.setSize(null,f.height());if("widgets"===window.pagenow&&g&&g.length){var d;d=a(".widgets-holder-wrap:not(#available-widgets)").find("div.widget");d.one("click.toggle-widget-expanded",function j(){var m=a(this);if(m.is(g)){setTimeout(function(){l.codemirror.refresh()},100)}});setTimeout(function(){l.codemirror.refresh()},100);h.attr({role:"textbox","aria-multiline":"true","aria-labelledby":f.attr("id")+"-label","aria-describedby":"editor-keyboard-trap-help-1 editor-keyboard-trap-help-2 editor-keyboard-trap-help-3 editor-keyboard-trap-help-4"});a("#"+f.attr("id")+"-label").on("click",function(){l.codemirror.focus()});f.on("change",function(){if(this.value!==l.codemirror.getValue()){l.codemirror.setValue(this.value)}});l.codemirror.on("change",function(){var m=l.codemirror.getValue();if(m!==f.val()){f.val(m).trigger("change")}});if(wp.customize){l.codemirror.on("keydown",function e(o,n){var m=27;if(m===n.keyCode){n.stopPropagation()}})}}})}return this};a.fn.hocwpCodeEditor.defaults={autoRefresh:true};(function(){a("textarea[data-code-editor='1']").hocwpCodeEditor()})()});