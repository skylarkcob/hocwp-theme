window.hocwpTheme=window.hocwpTheme||{};jQuery(document).ready(function(b){var a=b("body");b.fn.hocwpUpdateMeta=function(c){return this.each(function(){var f=b(this),e=f.attr("data-meta-type"),d=f.attr("data-meta-key"),j=f.attr("data-meta-value"),i=f.attr("data-id"),h=f.attr("data-change-value");var g=b.extend({},b.fn.hocwpUpdateMeta.defaults,c);if(!b.trim(e)){e=g.meta_type}f.on("click",function(){var k=f.attr("data-value-type"),l=parseInt(f.attr("data-require-login")),m=f.attr("data-confirm-message");if(1==l&&!a.hasClass("logged-in")){window.location.href=hocwpTheme.loginUrl;return}if(!b.trim(m)||confirm(m)){a.trigger("hocwpTheme:ajaxStart",[f]);b.ajax({type:"POST",dataType:"JSON",url:hocwpTheme.ajaxUrl,cache:true,data:{action:"hocwp_theme_ajax",callback:"update_meta",method:"post",meta_type:e,meta_key:d,meta_value:j,object_id:i,value_type:k,change_id:f.attr("data-object-id"),change_value:h,nonce:hocwpTheme.nonce},success:function(p){if(p.success){if(p.data&&p.data.meta_value){j=p.data.meta_value;f.attr("data-meta-value",j)}var n=f.parent(),r=n.find(f.attr("data-display-result"));if(r.length&&p.data&&p.data.formatted_meta_value){r.html(p.data.formatted_meta_value)}if("up_down"===k){f.addClass("disabled");f.prop("disabled",true)}var o=f.attr("data-text"),q=f.attr("data-undo-text");if(p.data&&p.data.job_action&&"undo"==p.data.job_action&&b.trim(o)){f.html(o)}else{if(p.data&&p.data.job_action&&"do"==p.data.job_action&&b.trim(q)){f.html(q)}}}f.trigger("hocwpUpdateMeta:ajaxSuccess",[f,p]);if(p.data&&p.data.message&&b.trim(p.data.message)){alert(p.data.message)}},complete:function(n){a.trigger("hocwpTheme:ajaxComplete",[f,n]);f.blur()}})}})})};b.fn.hocwpUpdateMeta.defaults={meta_type:"post"};(function(){a.find("[data-ajax-meta='1']").hocwpUpdateMeta();a.on("hocwpTheme:ajaxDataChange",function(){a.find("[data-ajax-meta='1']").hocwpUpdateMeta()})})()});