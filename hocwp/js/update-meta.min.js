window.hocwpTheme=window.hocwpTheme||{};jQuery(document).ready(function(b){var a=b("body");b.fn.hocwpUpdateMeta=function(c){return this.each(function(){var f=b(this),e=f.attr("data-meta-type"),d=f.attr("data-meta-key"),j=f.attr("data-meta-value"),i=f.attr("data-id"),h=f.attr("data-change-value");var g=b.extend({},b.fn.hocwpUpdateMeta.defaults,c);if(!b.trim(e)){e=g.meta_type}f.on("click",function(){var k=f.attr("data-value-type"),l=parseInt(f.attr("data-require-login"));if(1==l&&!a.hasClass("logged-in")){window.location.href=hocwpTheme.loginUrl;return}a.trigger("hocwpTheme:ajaxStart",[f]);b.ajax({type:"POST",dataType:"JSON",url:hocwpTheme.ajaxUrl,cache:true,data:{action:"hocwp_theme_ajax",callback:"update_meta",method:"post",meta_type:e,meta_key:d,meta_value:j,object_id:i,value_type:k,change_id:f.attr("data-object-id"),change_value:h,nonce:hocwpTheme.nonce},success:function(o){if(o.success){if(o.data&&o.data.meta_value){j=o.data.meta_value;f.attr("data-meta-value",j)}var m=f.parent(),q=m.find(f.attr("data-display-result"));if(q.length&&o.data&&o.data.formatted_meta_value){q.html(o.data.formatted_meta_value)}if("up_down"===k){f.addClass("disabled");f.prop("disabled",true)}var n=f.attr("data-text"),p=f.attr("data-undo-text");if(o.data&&o.data.job_action&&"undo"==o.data.job_action&&b.trim(n)){f.html(n)}else{if(o.data&&o.data.job_action&&"do"==o.data.job_action&&b.trim(p)){f.html(p)}}}f.trigger("hocwpUpdateMeta:ajaxSuccess",[f,o]);if(o.data&&o.data.message&&b.trim(o.data.message)){alert(o.data.message)}},complete:function(m){a.trigger("hocwpTheme:ajaxComplete",[f,m]);f.blur()}})})})};b.fn.hocwpUpdateMeta.defaults={meta_type:"post"};(function(){b("[data-ajax-meta='1']").hocwpUpdateMeta()})()});